---
layout:     post
title:      "Redis - Redis入门"
subtitle:   " \"Redis Knowledge - 02\""
date:       2021.01.02 12:29:00
author:     "Wuy"
header-img: "img/post-bg-2020.jpg"
catalog: true
tags:
    - 学习笔记
    - 读书
    - Redis

---

> *"Keep Learning Redis"*

# Redis 概述

Redis（Remote Dictionary Server），即远程字典服务。
是一个开源的使用ANSI C语言编写的、支持网络的、可基于内存亦可持久化的日志型、Key-Value数据库、并提供多种语言的API。

## Redis的作用

- 内存存储、持久化；
- 效率高，可用于高速缓存；
- 发布订阅信息；
- 地图信息分析；
- 计时器、计数器；

## Redis的特性

- 速度快；
- 支持多种数据结构（5种）；
- 持久化；
- 自动操作；
- 支持多种语言；
- 主从复制；
- 支持分布式存储。

## Redis性能测试

![image-20210102174120859](https://i.loli.net/2021/01/02/6L4CPxIjlYoyTWn.png)

1. 100个并发连接（100000个请求）

```bash
redis-benchmark -h localhost -p 6379 -c 100 -n 100000
```

分析测试结果的方式：

![image-20210102175810211](https://i.loli.net/2021/01/02/huMY6tky4ivzgJp.png)

## Redis基础知识

1. Redis有16个数据库，默认使用第一个；可以使用`select`进行切换；

2. 使用`keys *`查看数据库所有的`Key`；

3. 使用`flushdb`清空数据库；

4. 使用`flushall`清空所有的数据库；

5. Redis是单线程的：官方表示，Redis是基于内存操作的，CPU不是Redis性能瓶颈，其实是根据机器的内存和网络带宽，既然可以使用单线程来实现，就使用单线程了。Redis是将所有的数据都存放在内存中，所以说使用单线程去操作效率就是最高的，多线程CPU上下文会切换，就会耗时。

6. Redis的基本类型：

   ```bash
   127.0.0.1:6379> move name 1
   (integer) 0
   127.0.0.1:6379> get name
   (nil)
   127.0.0.1:6379> flushall
   OK
   127.0.0.1:6379> flushdb
   OK
   127.0.0.1:6379> type name
   none
   127.0.0.1:6379> exists name
   (integer) 0
   127.0.0.1:6379> set name wuyan
   OK
   127.0.0.1:6379> set age 1
   OK
   127.0.0.1:6379> expire age 10
   (integer) 1
   127.0.0.1:6379> ttl age
   (integer) 7
   127.0.0.1:6379> type name
   string
   127.0.0.1:6379> type age
   none
   ```

   

# Redis的五大基本数据类型

1. `String`

   下面列出了一些常用的指令：

   ```bash
   127.0.0.1:6379> append age wuyan #如果当前key不存在，append就等于set
   (integer) 5
   127.0.0.1:6379> get age
   "wuyan"
   127.0.0.1:6379> strlen age
   (integer) 5
   
   #******************************************************#
   
   127.0.0.1:6379> set views 0
   OK
   127.0.0.1:6379> incr views #自增
   (integer) 1
   127.0.0.1:6379> decr views
   (integer) 0
   127.0.0.1:6379> incrby views 10 #可以设置步长
   (integer) 10
   
   #******************************************************#
   
   127.0.0.1:6379> set key1 "wuyantest"
   OK
   127.0.0.1:6379> getrange key1 0 2
   "wuy"
   127.0.0.1:6379> getrange key1 0 -1
   "wuyantest"
   127.0.0.1:6379> set key2 abcdefgh
   OK
   127.0.0.1:6379> setrange key2 1 xx
   (integer) 8
   127.0.0.1:6379> get key2
   "axxdefgh"
   
   #******************************************************#
   
   127.0.0.1:6379> setex key3 30 "hello" #设置key3的值为“hello”， 30秒后过期
   OK
   127.0.0.1:6379> ttl key3
   (integer) 26
   127.0.0.1:6379> setnx key4 redis
   (integer) 1
   127.0.0.1:6379> get key4
   "redis"
   127.0.0.1:6379> setnx key4 mongodb #不存在才设置
   (integer) 0
   127.0.0.1:6379> get key4
   "redis"
   
   #******************************************************#
   
   127.0.0.1:6379> mset k1 v1 k2 v2 k3 v3 #同时设置多个值，也可以同时获取多个值
   OK
   127.0.0.1:6379> msetnx k1 v1 k4 v4 # msetnx是一种原子性的操作，要么同时成功，要么同时失败
   (integer) 0
   127.0.0.1:6379> get k4
   (nil)
   
   #******************************************************#
   
   127.0.0.1:6379> set user:1 {name:wuyan,age:3}
   OK
   127.0.0.1:6379> set user {name:wuyan,age:3}
   OK
   127.0.0.1:6379> mset user:1:name wuyan user:1:age 2 #设置一个user：1对象，值为json字符来保存一个对象，这里的key的设计比较巧妙：user:{id}:{field}
   OK
   127.0.0.1:6379> mget user:1:name user:1:age
   1) "wuyan"
   2) "2"
   
   #******************************************************#
   
   127.0.0.1:6379> getset db redis #如果不存在值，则返回nil（先get再set）
   (nil)
   127.0.0.1:6379> get db
   "redis"
   127.0.0.1:6379> getset db mongodb #如果存在值，则获取原来的值，并设置新的值
   "redis"
   127.0.0.1:6379> get db
   "mongodb"
   ```

   `String`类型的使用场景：`value`除了是我们的字符串还可以是我们的数字：

   - 计数器
   - 统计多单位的数量
   - 对象缓存存储































